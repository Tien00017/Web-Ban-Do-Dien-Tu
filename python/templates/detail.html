{% extends 'store/base.html' %} {% load humanize %} {% block content %}
<div class="bg-white rounded shadow-sm p-4">
  <div class="row">
    <div class="col-md-5 text-center">
      {% if product.image %}<img
        src="{{ product.image.url }}"
        class="img-fluid rounded"
      />{% endif %}
    </div>
    <div class="col-md-7">
      <h2 class="fw-bold">{{ product.name }}</h2>
      <p class="text-muted">Danh mục: {{ product.category.name }}</p>
      <h3 class="price-text my-3">{{ product.price|intcomma }}₫</h3>
      <div class="d-flex gap-2">
        <a
          href="{% url 'add_to_cart' product.id %}"
          class="btn btn-cps btn-lg px-5"
          >MUA NGAY</a
        >
      </div>
      <div class="mt-4">
        <h5>Mô tả sản phẩm</h5>
        <p>{{ product.description|linebreaks }}</p>
      </div>
    </div>
  </div>
</div>

<div class="bg-white rounded shadow-sm p-4 mt-3">
  <h4>Đánh giá khách hàng</h4>
  {% if user.is_authenticated %}
  <form method="POST" class="mb-4 p-3 bg-light rounded">
    {% csrf_token %}
    <div class="mb-2">
      <label>Số sao:</label>
      <select name="rating" class="form-select w-auto d-inline">
        <option value="5">5 Sao (Tuyệt vời)</option>
        <option value="4">4 Sao (Tốt)</option>
        <option value="3">3 Sao (Bình thường)</option>
      </select>
    </div>
    <textarea
      name="comment"
      class="form-control mb-2"
      rows="3"
      placeholder="Nhập đánh giá của bạn..."
      required
    ></textarea>
    <button type="submit" class="btn btn-danger">Gửi đánh giá</button>
  </form>
  {% else %}
  <p><a href="{% url 'login' %}">Đăng nhập</a> để đánh giá.</p>
  {% endif %} {% for r in reviews %}
  <div class="border-bottom py-3">
    <strong>{{ r.user.username }}</strong>
    <span class="text-warning ms-2"
      >{% for i in "x"|rjust:r.rating %}★{% endfor %}</span
    >
    <p class="mb-0 text-muted small">{{ r.created_at|date:"d/m/Y H:i" }}</p>
    <p class="mt-1">{{ r.comment }}</p>
  </div>
  {% empty %}
  <p>Chưa có đánh giá nào.</p>
  {% endfor %}
</div>
{% endblock %}
